# Motercontroller_vol1

## 何するもの？
* VNH5019搭載のモーターコントローラの内部のプログラム
* こいつがスレーブってこと

### CAN通信について
* IDはすべて16進数でなく10進数で表現
* 送信するdata[]は0～255の10進数で表現


## 送信データ(マスター -> スレーブ)
#### コントローラーID
0～7の8段階で設定可能


ID : 199

data[0]:新しいID(0～7)
data[1～7]:0

#### モーターENABLE
これを送信しないとENABLEにならない

ID : 110 + コントローラーID

data[0～7]:0

#### モーターDISABLE

ID : 120 + コントローラーID

data[0~7]:0

#### モードチェンジ

ID : 130 + コントローラーID

data[0]:指定モード(1:角度制御モード 2:速度制御モード 3:duty制御モード)

data[1～7]:0

#### 指令値送信

ID : 140 + コントローラーID

##### mode1:角度制御モードの場合
角度指令値:16bit(0 ～ 65536)が(-360° ～ 360°)に対応

角速度指令値:16bit(0 ～ 65536)が(0rad/s ～ 200pi rad/s)に対応


data[0]:角度指令値の上位bit

data[1]:角度指令値の下位bit

data[2]:角速度指令値の上位bit

data[3]:角速度指令値の下位bit

data[4～7]:0


##### mode2:角速度制御モードの場合
角速度指令値:角速度指令値:16bit(0 ～ 65535)が(0rad/s ～ 200pi rad/s)に対応

data[0]:角速度指令値の上位bit

data[1]:角速度指令値の下位bit

data[2]:モーターの正逆(0 or 1)

data[3～7]:0

##### mode3:duty制御モードの場合
duty:0～255

data[0]:モーターの正逆(0 or 1)

data[1]:duty

### エンコーダの原点リセット
ID : 150 + コントローラーID

data[0～7]:0

### パラメータ送信

ID : 160 + コントローラーID

#### 送信するデータ
* 減速比 : (0 ～ 65535)が(0 ～ 2000)に対応
* ゲインkp : (0 ～ 65535)が(0 ～ 2000)に対応
* ゲインki : (0 ～ 65535)が(0 ～ 2000)に対応
* ゲインkd : (0 ～ 65535)が(0 ～ 2000)に対応

data[0] : 減速比の上位bit

data[1] : 減速比の下位bit

data[2] : ゲインkpの上位bit

data[3] : ゲインkpの下位bit

data[4] : ゲインkiの上位bit

data[5] : ゲインkiの下位bit

data[6] : ゲインkdの上位bit

data[6] : ゲインkdの下位bit
